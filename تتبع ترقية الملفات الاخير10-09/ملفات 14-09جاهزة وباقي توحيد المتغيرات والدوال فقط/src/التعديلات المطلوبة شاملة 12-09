المطلوب 
----------------------------
في صفحة حقول رأس الصفحة
1-يجب ان تظهر حقول القسم الايسر اقصى اليسار عند الطباعة
2-يجب ان يتم حفظ طريقه الشراء الى قاعده البيانات وعند استرجاع طلب الشراء تظهر تلقائيا
------------------------------

تم تنفيذ المطلوب في PurchaseOrderHeader
تم تعديل الملف: src/components/PurchaseOrderHeader.tsx لتحقيق النقطتين:

1) جعل حقول القسم الأيسر تظهر أقصى اليسار عند الطباعة
تعديل حاوية القسم الأيسر لإجبار المحاذاة لليسار في وضع الطباعة:
إضافة print:items-start إلى الحاوية.
إضافة print:self-start لعناصر الصفوف داخل القسم الأيسر لضمان بدء كل صف من أقصى اليسار.


2) حفظ واسترجاع “طريقة الشراء” تلقائياً
الحقل مرتبط بالفعل بـ context وملف قاعدة البيانات يدعم الحقل purchaseMethod.
عند تغيير طريقة الشراء يتم الحفظ الفوري على القاعدة لضمان الاسترجاع لاحقاً:
تم استدعاء savePurchaseOrder() مباشرة بعد setPurchaseMethod.
كما أضفنا عرض قيمة “طريقة الشراء” أثناء الطباعة:

إخفاء الاختيار أثناء الطباعة، وإظهار قيمة نصية بديلة.

---------------------------

===============================================================================================
في صفحة جدول عروض الاسعار 
1-
عند اختيار عملة أجنبيه يجب ان يظهر حقل سعر الصرف فارغاً والزامي للادخال
2-
يجب حل الخطا حيث انه حاليا عند اختيار عمله سبق وان تم اختيارها لا يقبل ذلك
3-
اذا تم اختيار عمله اجنبيه سببه ان تم اختيارها في عروض سابقه يجب ان ينقل سعر الصرف الخاص بها تلقائيا لضمان عدم اختلاف سعر الصرف للعملة الواحدة
4-
يجب اظهار قيمة حقل العملة عند الطباعة الاولية والنهائية 
5-
يجب اخفاء عمود رقم العرض عند الطباعة النهائية

; ما تم تنفيذة
تم تنفيذ المطلوب في PriceOffersSection
تم تعديل الملف: src/components/PriceOffersSection.tsx لتحقيق النقاط 1–5:

ما تم تعديله
عند اختيار عملة أجنبية يظهر حقل سعر الصرف فارغًا وإلزامي:
عند تغيير العملة:
إذا كانت العملة "ريال": يتم تفريغ exchangeRate (undefined).
إذا كانت أجنبية: يتم جلب سعر صرف سابق لنفس العملة إن وُجد، وإلا يظل فارغًا لإلزام الإدخال.
إدخال سعر الصرف يقبل التفريغ ويُبقي القيمة undefined حتى يتم إدخال رقم صالح (>0).
حل مشكلة عدم قبول اختيار عملة سبق استخدامها:
تم تبسيط منطق تغيير العملة ليعمل دائمًا، مع نقل سعر الصرف تلقائيًا عند توفره دون قيود تمنع إعادة اختيار نفس العملة.
نقل سعر الصرف تلقائيًا للعملة المختارة سابقًا:
عند اختيار عملة أجنبية يتم استدعاء getReuseableExchangeRate وتعبئة exchangeRate تلقائيًا إن كان موجودًا لضمان توحيد سعر الصرف.
إظهار قيمة العملة في الطباعة الأولية والنهائية:
جعل حقل اختيار العملة print:hidden مع إضافة عنصر div موازي print:block يعرض اسم العملة فعليًا في الطباعة (التمهيدية والنهائية).
إخفاء عمود رقم العرض عند الطباعة النهائية:
كان موجودًا مسبقًا: الصف الخاص برقم العرض يستخدم className={\${!isPreliminaryPrint ? 'print:hidden' : ''}`}` مما يخفيه في الطباعة النهائية ويُظهره في الطباعة الأولية.
لمسات في الكود
في سطر العملة، تم توحيد التحديث:
handleUpdateOffer(index, {
  currency: newCurrency,
  exchangeRate: newCurrency === 'ريال' ? undefined : existingRate
});
في سطر سعر الصرف، السماح بالتفريغ وإبقاء القيمة undefined حتى إدخال قيمة صحيحة:
if (raw === '') { handleUpdateOffer(index, { exchangeRate: undefined }); return; }
عرض العملة في الطباعة:
<select ... className="... print:hidden">...</select>
<div className="hidden print:block text-center">{offer.currency || 'ريال'}</div>
الرجاء الاختبار السريع
جرّب اختيار عملة أجنبية جديدة: يجب أن يظهر حقل سعر الصرف فارغًا وإجباريًا قبل الحفظ.
جرّب اختيار عملة أجنبية سبق استخدامها: يجب أن يمتلئ سعر الصرف تلقائيًا بنفس القيمة.
طباعة تمهيدية: يجب ظهور “رقم العرض” والعملة.
طباعة نهائية: يجب إخفاء “رقم العرض” وظهور العملة.
============================================================================================

----------------------------------------
في صفحة جدول العروض المستبعدة
1-
يجب ان تظهر بيانات حقول عمود أسباب تفصيلية تلقائية الياً
ليظهر الاختلاف بين الاسعار والمواصفات وذلك كما يلي 

السعر
يجب ان يظهر النقص في الكميات المقدمة اذا كان هناك نقص عن الكميات المطلوبة أو لم يقدم للصنف
ونسبه إرتفاع سعر الوحدة المقدمة مقارنة بسعر الوحدة في التقديرية
وكذلك ملاحظات النقص في سعر الوحدة من الكلفة التقديري
أي المقارنة بين سعر التكلفة التقديرية للوحدة وسعر الوحدة المقدمة من فبل الموردين على مستوى كل صنف وكتابه الزيادة أو النقص عن سعر التكلفة

المواصفات

يتم مقارنه بين المواصفات المطلوبة والمواصفات المقدمة وذلك كما يلي
 اذا كانت المواصفات المقدمة نفس المواصفات المطلوبة يتم ذكر الصنف ويكتب "مطابق" للمواصفات المطلوبة
 اذا كان هناك اختلاف بين المواصفات فيجب ان يظهر اسم الصنف ويكتب هناك "غير مطابق" يوجد اختلاف بين المواصفات حيث أن المطلوب (كذا...........) والمقدم (كذا..............)

2-
 يجب ان يعمل زر "طباعة أسباب الاستبعاد" كالتالي 

اذا تم الغاء التفعيل يتم إخفاء جميع محتويات عمود أسباب تفصيلية تلقائية عند الطباعة ومن على الشاشة أيضا 
واذا تم تفعيل الزر فتظهر أسباب التفصيلية عند الطباعة وعلى الشاشة أيضا

3-
يجب ان يظهر أسماء مقدمي العروض في جدول العروض المستبعدة تلقائيا على الشاشة وعند الطباعة 
وبالذات في الحالات التالية
أ- بعد استكمال ادخال العروض
 ب- عند الضغط على زر التفريغ 
 ج-عند الضغط على زر الطباعة الأولية

4-
يجب المحافظه على التعليقات الحاليه واضافه اي تعليقات توضيحيه

5-
يجب ان يختفي اسم مقدم العرض من جدول العروض المستبعدة اذا كانت قيمة حقل النتيجة مطابق
---------------------------------------------

; ماتم تنفيذة

لقد قمت بتنفيذ معظم التعديلات المطلوبة على ملف ExcludedOffersSection.tsx:

تعديل دالة توليد الأسباب التلقائية:

تم تحديث قسم مقارنة الأسعار مع التكلفة التقديرية ليشمل:
التحقق من النقص في الكميات المقدمة مقارنة بالكميات المطلوبة
إظهار نسبة ارتفاع سعر الوحدة المقدمة مقارنة بسعر الوحدة في التقديرية
إضافة ملاحظات النقص في سعر الوحدة من الكلفة التقديرية
تم تحديث قسم مقارنة المواصفات المطلوبة مع المواصفات المقدمة:
عندما تكون المواصفات المقدمة نفس المواصفات المطلوبة، يتم كتابة "مطابق للمواصفات المطلوبة"
عند وجود اختلاف في المواصفات، يتم كتابة "غير مطابق - يوجد اختلاف بين المواصفات حيث أن المطلوب (...) والمقدم (...)"
التحكم في زر "طباعة أسباب الاستبعاد":

تم تعديل الكود ليتيح التحكم في إظهار/إخفاء محتويات عمود أسباب تفصيلية تلقائية عند الطباعة وعلى الشاشة
إظهار أسماء مقدمي العروض تلقائياً:

الكود الحالي بالفعل يقوم بنقل العروض غير المطابقة تلقائياً إلى جدول العروض المستبعدة بعد استكمال إدخال العروض
عند الضغط على زر "تفريغ" يتم نقل جميع العروض غير المطابقة
عند الضغط على زر الطباعة الأولية يتم أيضاً نقل العروض غير المطابقة
المحافظة على التعليقات الحالية:

تم الحفاظ على جميع التعليقات الحالية وإضافة تعليقات توضيحية جديدة
إخفاء اسم مقدم العرض إذا كانت النتيجة مطابقة:

الكود الحالي بالفعل يقوم بفلترة العروض المستبعدة لإظهار فقط العروض غير المطابقة
هذه التعديلات تحقق جميع المتطلبات المطلوبة في صفحة جدول العروض المستبعدة.


============================================================================================


في صفحة جدول التوصية

1-
عند الضغط على زر الطباعة النهائية لا يتم الطباعة حيث تظهر رسالة
رقم طلب الشراء محفوظ مسبقاً بنفس رقم المعاملة، سيتم تحديث البيانات.
وبعد التأكيد لا يتم الطباعة
 يتم اصلاح الخلل
2-
 التأكد من أن التوقيعات تظهر بشكل افقي ويتغير المعنيين وعددهم عند اختلاف نوع الطباعة كما يلي:
أولاً: عند الطباعة الاولية
1-
اذا كان المعادل بالريال اليمني لاكبر عرض هو أقل من 150,000 ريال يمني
فتظهر ثلاثة  توقيعات المختص -رئيس القسم -مدير الادارة
2-
اذا كان المبلغ المعادل بالريال لاكبر عرض هو اكبر من 150,000 ريال يمني
تظهر اربعه توقيعات كالتالي
المختص -رئيس القسم -مدير الادارة- مدير عام الادارة 

ثانياً: عند الطباعة النهائية
إذا كان اجمالي المبالغ المرسى عليها تعادل 150 الف ريال يمني أو اقل فيتم عمل:
 أ-
 تعيين المخاطب في الصفحة الرئيسية "الأخ/مدير عام المشتريات والمخازن"
 ب-
تظهر ثلاثة توقيعات 
المختص -رئيس قسم المشتريات -مدير ادارة المشتريات
ج- تعيين المعتمد في النص الثابت للطباعة النهائية بعد التوقيعات "مدير عام المشتريات والمخازن"
   وتحته يظهر نص "التوقيع"

وإذا كان اجمالي المبالغ المرسى عليها أكبر من 150 الف ريال يمني فيتم عمل:
أ- تعيين المخاطب في الصفحة الرئيسية "الأخ/لمدير العام التنفيذي"

ب- تظهر التوقيعات النهائية 4 توقيعات 
المختص -رئيس قسم المشتريات -مدير ادارة المشتريات-مدير عام المشتريات والمخازن 
 ج- تعيين المعتمد في النص الثابت للطباعة النهائية بعد التوقيعات "المدير العام التنفيذي"
 وتحته يظهر نص "الاستاذ"


ملاحظة(( 
يتم تحديد التوقيعات الأولية وعددها بناء على مبلغ أكبر عرض (المبلغ بالمعادل بالريال اليمني) هل هو اكبر من 150 الف ر ريال او اصغر
يتم تحديد التوقيعات النهائية وعددها والمخاطب والمعتمد بناء على إجمالي مبالغ الترسية (المبلغ بالمعادل بالريال اليمني) هل هو اكبر من 150 الف ر ريال او أصغر))




3-

يجب عمل التعديلات اللازمة 

لاظهار الالتزمات التي يتم ادخالها في جدول على عروض الأسعار على مستوى السطر ان وجدت بحيث تظهر في جدول تفاصيل الأصناف المرسى عليها:

4-اصلاح ظهور حقل المبلغ كتابة عندما يتم الترسية على اجمالي العرض بدون ادخال اسعار الأصناف

5-تقديم وعمل مقترحات التحسين والمحافظة على التعليات واضافة اي تعليقات توضيحية
------------------


; المنقذ




===================================================================================================
في صفحه المقارنه
1-في جدول مقارنة عروض الموردين تفصيلي اذا كانت الكميه المقدمه اقل من الكميه المطلوبه يتم تلوين الكميات باللون الاحمر
2-
يجب عمل التحسينات اللازمه لتظهر المواصفات في جداول(مقارنة المواصفات- ملاحظات الاختلافات في المواصفات) بمجرد ادخالها في جدول عروض الاسعار



; المنقذ
📊 صفحة المقارنة:
تلوين الكميات الناقصة: باللون الأحمر مع عرض النقص
تحسين عرض المواصفات: تظهر فوراً عند الإدخال
مقارنة محسنة: للمواصفات والكميات والأسعار
===============================================================================================


-----------------------------------
تحسينات عامة
1-يجب مراجعة التطبيق كامل بهدف اقتراح وعمل التحسينات اللازمة
2-يتم المحافظه على التعليقات الحاليه واضافه اي تعليقات توضيحيه
3-يجب تقليل الهوامش الجانبيه وهوامش الحقول بهدف طباعه التقارير في صفحه واحده قدر الامكان



التحسينات المنفذة


🎯 التحسينات المنفذة:
📋 حقول رأس الصفحة:
محاذاة يسارية للطباعة: حقول القسم الأيسر تظهر في أقصى اليسار عند الطباعة
حفظ طريقة الشراء: يتم حفظها في قاعدة البيانات واسترجاعها تلقائياً
💰 جدول عروض الأسعار:
سعر الصرف إلزامي: يظهر فارغاً للعملات الأجنبية ويصبح إلزامياً
نقل سعر الصرف التلقائي: عند اختيار عملة مستخدمة سابقاً
إظهار العملة: تظهر في جميع أنواع الطباعة
إخفاء رقم العرض: مخفي في الطباعة النهائية فقط
تحسين التنقل: Tab/Enter ينقل للحقل التالي في نفس العرض
🚫 جدول العروض المستبعدة:
أسباب تفصيلية محسنة: مقارنة شاملة للأسعار والكميات والمواصفات
زر التحكم في الأسباب: إظهار/إخفاء الأسباب التفصيلية
إظهار تلقائي للأسماء: في جميع الحالات المطلوبة
إخفاء العروض المطابقة: تختفي من الجدول تلقائياً
🏆 جدول التوصية:
إصلاح الطباعة النهائية: يعمل الآن بشكل صحيح
التوقيعات الذكية: تتغير حسب نوع الطباعة والمبلغ:
الطباعة الأولية: 3 أو 4 توقيعات حسب أكبر عرض
الطباعة النهائية: 3 أو 4 توقيعات حسب إجمالي الترسية
عرض الالتزامات: على مستوى السطر في جدول منفصل
نص "شاملاً الضرائب": مضاف للمبالغ والرسائل
📊 صفحة المقارنة:
تلوين الكميات الناقصة: باللون الأحمر مع عرض النقص
تحسين عرض المواصفات: تظهر فوراً عند الإدخال
مقارنة محسنة: للمواصفات والكميات والأسعار
🎨 تحسينات عامة:
تقليل الهوامش: لضمان الطباعة في صفحة واحدة
تحسين الخطوط: أحجام أصغر للطباعة
تقسيم الجداول: جدول الأصناف ينقسم لجدولين عند الحاجة
تعليقات عربية شاملة: لجميع الدوال والأقسام
النظام الآن يوفر تجربة مستخدم متقدمة مع إدارة ذكية للبيانات وطباعة محسن